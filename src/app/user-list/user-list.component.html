<div class="flex justify-between items-center mt-4 mb-2">
  <h2 class="text-2xl font-bold">User List</h2>
  <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Add User</button>
</div>

<div *ngIf="loading$ | async" class="text-center mt-4">
  <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500" role="status">
    <span class="sr-only">Loading...</span>
  </div>
  <p class="mt-2 text-gray-600">Loading users...</p>
</div>

<table *ngIf="!(loading$ | async)" class="min-w-full divide-y divide-gray-200 mt-4">
  <thead class="bg-gray-50">
    <tr>
      <th *ngFor="let header of headers" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ header }}</th>
      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
    </tr>
  </thead>
  <tbody class="bg-white divide-y divide-gray-200">
    <tr *ngFor="let user of (users$ | async)">
      <td *ngFor="let header of headers" [attr.contenteditable]="user.editing" (blur)="editUser(user, header, $event)" class="px-6 py-4 whitespace-nowrap">
        {{ getPropertyValue(user, header) }}
      </td>
      <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded text-sm mr-2" [routerLink]="['/user', user.id]">View</button>
        <button class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-2 rounded text-sm mr-2" (click)="user.editing = !user.editing">{{ user.editing ? 'Save' : 'Edit' }}</button>
        <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded text-sm" (click)="deleteUser(user)">Delete</button>
      </td>
    </tr>
  </tbody>
</table>
