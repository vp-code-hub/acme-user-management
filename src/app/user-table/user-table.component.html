<div class="w-full space-y-4">
  <div class="flex justify-between items-center mb-4">
    <input
      type="text"
      placeholder="Filter users..."
      [(ngModel)]="filterValue"
      (input)="onFilterChange($event)"
      class="p-2 border rounded w-1/3"
    />
    <app-add-user-sheet></app-add-user-sheet>
  </div>

  <div class="rounded-md border">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            <input type="checkbox" />
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"
            (click)="onSort('name')"
          >
            Name
            <span *ngIf="sortColumn === 'name'">{{ sortDirection === 'asc' ? ' ▲' : ' ▼' }}</span>
          </th>
          <th
            *ngIf="!isMobile()"
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"
            (click)="onSort('language')"
          >
            Language
            <span *ngIf="sortColumn === 'language'">{{ sortDirection === 'asc' ? ' ▲' : ' ▼' }}</span>
          </th>
          <th
            *ngIf="!isMobile()"
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Bio
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Actions
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <tr *ngIf="loading">
          <td colspan="5" class="px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500">
            Loading users...
          </td>
        </tr>
        <tr *ngIf="!loading && paginatedUsers.length === 0">
          <td colspan="5" class="px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500">
            No results.
          </td>
        </tr>
        <tr *ngFor="let user of paginatedUsers" class="hover:bg-gray-100 cursor-pointer">
          <td class="px-6 py-4 whitespace-nowrap">
            <input type="checkbox" />
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <input
              type="text"
              [value]="user.name"
              (blur)="onCellEdit(user, 'name', $event)"
              (keydown.enter)="$event.target.blur()"
              class="w-full p-1 border rounded"
            />
          </td>
          <td *ngIf="!isMobile()" class="px-6 py-4 whitespace-nowrap">
            <input
              type="text"
              [value]="user.language"
              (blur)="onCellEdit(user, 'language', $event)"
              (keydown.enter)="$event.target.blur()"
              class="w-full p-1 border rounded"
            />
          </td>
          <td *ngIf="!isMobile()" class="px-6 py-4 whitespace-nowrap truncate max-w-xs">
            {{ user.bio }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
            <button (click)="onViewUser(user.id)" class="text-indigo-600 hover:text-indigo-900 mr-4">View</button>
            <button (click)="onDeleteUser(user.id)" class="text-red-600 hover:text-red-900">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="flex flex-col md:flex-row items-center justify-between gap-4">
    <div class="text-sm text-gray-700">
      <!-- Selected rows count will go here -->
    </div>
    <div class="flex flex-col md:flex-row items-center gap-4 w-full justify-center md:justify-end">
      <div class="flex items-center space-x-2">
        <label for="pageSize" class="text-sm font-medium">Rows per page</label>
        <select id="pageSize" [ngModel]="pageSize" (change)="onPageSizeChange($event)" class="p-2 border rounded">
          <option *ngFor="let size of pageSizes" [value]="size">{{ size }}</option>
        </select>
      </div>

      <div class="flex items-center space-x-2">
        <button
          (click)="onPageChange(0)"
          [disabled]="currentPage === 0"
          class="p-2 border rounded"
        >
          &lt;&lt;
        </button>
        <button
          (click)="onPageChange(currentPage - 1)"
          [disabled]="currentPage === 0"
          class="p-2 border rounded"
        >
          &lt;
        </button>
        <span class="text-sm font-medium">Page {{ currentPage + 1 }} of {{ totalPages }}</span>
        <button
          (click)="onPageChange(currentPage + 1)"
          [disabled]="currentPage === totalPages - 1"
          class="p-2 border rounded"
        >
          &gt;
        </button>
        <button
          (click)="onPageChange(totalPages - 1)"
          [disabled]="currentPage === totalPages - 1"
          class="p-2 border rounded"
        >
          &gt;&gt;
        </button>
      </div>
    </div>
  </div>
</div>
